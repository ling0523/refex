!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Refex=t():e.Refex=t()}(window,function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1)}([function(e,t,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var s=function(){function e(t,i,n,r,s,o,a,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tag=t,this.attrs=i,this.cls=n,this.directives=r,this.events=s,this.text=o,this.id=a,this.nodeType=c,this.parent=void 0,this.children=[],this.isCloned=!1,this.elm=void 0,this.if=!0,this.forData={},this.useIf=!1,this.useElseIf=!1,this.useElse=!1}return r(e,[{key:"dealFor",value:function(e){var t=this;if(this.directives.for){var i,r=Object.assign({},e.$data);Object.assign(r,this.getForData());var s=this.parseFor(r,this.directives.for.exp);if(!s)throw new Error("Invalid @for expression: "+this.directives.for.exp);delete this.directives.for;var o=this.getIndex(),a=[];if(Array.isArray(s.for))for(var c=s.for.length,f=0;f<c;f++){var d=this.clone(f,s,f);d.parent=this.parent,a.push(d),d.children.forEach(function(t){t.dealFor(e)})}else"object"==n(s.for)&&Object.keys(s.for).forEach(function(i,n){var r=t.clone(n,s,n,i);r.parent=t.parent,a.push(r),r.children.forEach(function(t){t.dealFor(e)})});(i=this.parent.children).splice.apply(i,[o,1].concat(a))}else this.children.forEach(function(t){t.dealFor(e)})}},{key:"init",value:function(e){var t=Object.assign({},e.$data);if(Object.assign(t,this.getForData()),1==this.nodeType){if(this.directives.if){if(this.directives["else-if"]||this.directives.else)throw new Error('"@if" and "@else-if" and "@else" cannot be used on the same node');this.if=this.parseExpression(t,this.directives.if.exp),this.useIf=!0,delete this.directives.if}if(this.directives["else-if"]){if(this.directives.else)throw new Error('"@else-if" and "@else" cannot be used on the same node');var i=this.getPrevBrotherNode();if(!i||!i.useIf)throw new Error('"@else-if" cannot be used alone');i.if?this.if=!1:this.if=this.parseExpression(t,this.directives["else-if"].exp),this.useElseIf=!0,delete this.directives["else-if"]}if(this.directives.else){var r=this.getPrevBrotherNode();if(!r||!r.useIf&&!r.useElseIf)throw new Error('"@else" cannot be used alone');if(r.useIf)r.if?this.if=!1:this.if=!0;else if(r.useElseIf){var s=r.getPrevBrotherNode();if(!s||!s.useIf)throw new Error('"@else" cannot be used alone');r.if||s.if?this.if=!1:this.if=!0}this.useElse=!0,delete this.directives.else}for(var o in this.directives){if(!e.$directives[o])throw new Error("The @"+o+" directive is undefined");this.directives[o].value=this.parseExpression(t,this.directives[o].exp)}var a={};for(var c in this.attrs){var f,d=null;if(f=this.parseText(t,c),this.attrs[c].match(/^\{\{(.*?)\}\}$/g)){var h=this.attrs[c].trim().length-2,u=this.attrs[c].trim().substring(2,h);d=this.parseExpression(t,u)}else d=this.parseText(t,this.attrs[c]);""===d&&(d=!0),a[f]=d}if(this.attrs=a,this.cls){var l={};if(this.cls.match(/^\{\{(.*?)\}\}$/g)){var v=this.cls.trim().length-2,p=this.cls.trim().substring(2,v),y=this.parseExpression(t,p);Array.isArray(y)?y.forEach(function(e){l[e]=!0}):"object"==(void 0===y?"undefined":n(y))&&y?l=Object.assign({},y):"string"==typeof y&&y&&(l[y]=!0)}else this.parseText(t,this.cls).split(/\s+/g).forEach(function(e){l[e]=!0});this.cls=l}else this.cls={};for(var m in this.events)this.events[m]=this.eventHandler(t,m)}else 3==this.nodeType&&(this.text=this.parseText(t,this.text));this.children.forEach(function(t){t.init(e)})}},{key:"eventHandler",value:function(e,t){var i=this,n=null,r=[],s=this.events[t].modifier;if(!this.events[t].handler)throw new TypeError("The value of #"+t+" shoud not be undefined");var o=/(.*)+\((.*)\)/g.exec(this.events[t].handler);return o?(n=this.parseExpression(e,o[1]),o[2]&&(r=o[2].split(",").map(function(t){return i.parseExpression(e,t)}))):"function"!=typeof(n=this.parseExpression(e,this.events[t].handler))&&(n=this.events[t].handler),{handler:n,params:r,modifier:s}}},{key:"dealComponent",value:function(t){var i=this.tag.toLocaleLowerCase();if(t.$components[i]){var r={};for(var s in this.attrs)t.$components[i].props.includes(s)&&(r[s]=this.attrs[s],delete this.attrs[s]);var o=t.$components[i].render.apply(t.$data,[r]);if(!o)throw new Error('The template for component "'+i+'" is invalid');var a=null;if("string"==typeof o){var c=document.createElement("div");c.innerHTML=o.trim();var f=c.childNodes[0];if(1!=f.nodeType)throw new TypeError('The template for component "'+i+'" is invalid');(a=t._compile(this.id,f)).dealFor(t),a.init(t)}else"object"==(void 0===o?"undefined":n(o))&&((a=new e(o.tag,o.attrs,o.cls,o.directives,o.events,void 0,this.id,1)).createChildrenVnodes(o),a.if=o._if);if(a){a.dealComponent(t),a.parent=this.parent,a.events=Object.assign(a.events,this.events),a.directives=Object.assign(a.directives,this.directives),a.cls=Object.assign(a.cls,this.cls),a.attrs=Object.assign(a.attrs,this.attrs);var d=this.getIndex();this.parent.children.splice(d,1,a)}}else this.children.forEach(function(e){e.dealComponent(t)})}},{key:"createChildrenVnodes",value:function(t){var i=this;if(void 0===t.text||null===t.text)t.slots.forEach(function(t,n){var r=new e(t.tag,t.attrs,t.cls,t.directives,t.events,void 0,i.id+"_"+n,1);i.children.push(r),r.createChildrenVnodes(t)});else{var n=document.createTextNode(t.text),r=new e(n.nodeName,{},{},{},{},t.text,this.id+"_0",n.nodeType);this.children=[r]}}},{key:"dealDirectives",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.if&&1==this.nodeType){var n=Object.assign({},e.$data);for(var r in Object.assign(n,this.getForData()),this.directives){var s=e.$directives[r],o=[],a=this.directives[r].exp,c=this.directives[r].modifier,f=this.directives[r].value;o="beforeMount"==t||"unmounted"==t?[f,c,a,this]:[this.elm,f,c,a,this],s[t]&&s[t].apply(e.$data,o)}i&&this.children.forEach(function(i){i.dealDirectives(e,t)})}}},{key:"render",value:function(e){var t=this,i=null;if(this.if){if(1==this.nodeType){i=document.createElement(this.tag);var r=[];for(var s in this.cls)this.cls[s]&&r.push(s);for(var o in r.length&&i.setAttribute("class",r.join(" ")),this.attrs){var a=this.attrs[o];!1!==a&&null!==a&&void 0!==a&&(!0===a&&(a=""),"object"===(void 0===a?"undefined":n(a))&&(a=JSON.stringify(a)),a=String(a),i.setAttribute(o,a))}var c=function(n){i.addEventListener(n,function(i){t.events[n].modifier&&t.events[n].modifier.includes("self")&&i.currentTarget!=i.target||(t.events[n].modifier&&t.events[n].modifier.includes("stop")&&i.stopPropagation(),t.events[n].modifier&&t.events[n].modifier.includes("prevent")&&i.cancelable&&i.preventDefault(),"function"==typeof t.events[n].handler?t.events[n].handler.apply(e.$data,[i].concat(function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}(t.events[n].params))):t.executeExpression(e.$data,t.events[n].handler)(e.$data))},{once:t.events[n].modifier&&t.events[n].modifier.includes("once"),capture:t.events[n].modifier&&t.events[n].modifier.includes("capture"),passive:t.events[n].modifier&&t.events[n].modifier.includes("passive")})};for(var f in this.events)c(f);this.children.forEach(function(t){t.render(e),i.appendChild(t.elm)})}else 3==this.nodeType?i=document.createTextNode(this.text):8==this.nodeType&&(i=document.createComment(this.text));this.elm=i}else this.elm=document.createComment("@if")}},{key:"isSame",value:function(e){return this.tag===e.tag&&this.nodeType===e.nodeType&&this.if===e.if&&this.useIf===e.useIf&&this.useElseIf===e.useElseIf&&this.useElse===e.useElse}},{key:"compare",value:function(e,t,i){var n={};if(0==i)for(var r in this[t])e[t].hasOwnProperty(r)&&JSON.stringify(e[t][r])!==JSON.stringify(this[t][r])&&(n[r]=this[t][r]);else if(1==i)for(var s in this[t])e[t].hasOwnProperty(s)||(n[s]=this[t][s]);else if(2==i)for(var o in e[t])this[t].hasOwnProperty(o)||(n[o]=e[t][o]);return n}},{key:"getForData",value:function(){var e={};return Object.assign(e,this.forData),this.parent&&Object.assign(e,this.parent.getForData()),e}},{key:"copy",value:function(){var t=this.id,i=this.tag,n=Object.assign({},this.directives),r=new e(i,Object.assign({},this.attrs),Object.assign({},this.cls),n,Object.assign({},this.events),this.text,t,this.nodeType);r.if=this.if,r.isCloned=this.isCloned,r.forData=Object.assign({},this.forData),r.useIf=this.useIf,r.useElseIf=this.useElseIf,r.useElse=this.useElse;var s=[],o=!0,a=!1,c=void 0;try{for(var f,d=this.children[Symbol.iterator]();!(o=(f=d.next()).done);o=!0){var h=f.value.copy();h.parent=r,s.push(h)}}catch(e){a=!0,c=e}finally{try{!o&&d.return&&d.return()}finally{if(a)throw c}}return r.children=s,r}},{key:"clone",value:function(t,i,n,r){var s=this.id+"_copy_"+t,o=this.tag,a=Object.assign({},this.directives),c=new e(o,Object.assign({},this.attrs),this.cls,a,Object.assign({},this.events),this.text,s,this.nodeType);c.isCloned=!0,r?(c.forData[i.item]=i.for[r],c.forData[i.index]=n,c.forData[i.key]=r):(c.forData[i.item]=i.for[n],c.forData[i.index]=n);var f=[];for(var d in this.children){var h=this.children[d].clone(d,i,n,r);h.parent=c,f.push(h)}return c.children=f,c}},{key:"equal",value:function(e){return this.id==e.id&&this.tag==e.tag&&this.nodeType==e.nodeType&&this.if==e.if&&this.isCloned==e.isCloned&&this.useIf==e.useIf&&this.useElseIf==e.useElseIf&&this.useElse==e.useElse&&(1==this.nodeType?JSON.stringify(this.attrs)==JSON.stringify(e.attrs)&&(JSON.stringify(this.cls)==JSON.stringify(e.cls)&&(JSON.stringify(this.directives)==JSON.stringify(e.directives)&&(JSON.stringify(this.events)==JSON.stringify(e.events)&&(this.children.length==e.children.length&&this.children.every(function(t,i){return t.equal(e.children[i])}))))):this.text==e.text)}},{key:"getPrevBrotherNode",value:function(){var e=this.getIndex();if(e<=0)return null;var t=this.parent.children[e-1];return 1!=t.nodeType&&(t=t.getPrevBrotherNode()),t}},{key:"getIndex",value:function(){var e=-1;if(this.parent)for(var t=this.parent.children.length,i=0;i<t;i++)if(this.parent.children[i]===this){e=i;break}return e}},{key:"parseFor",value:function(e,t){var i=t.match(/([^]*?)\s+(?:in|of)\s+([^]*)/);if(i){var r=this.parseExpression(e,i[2].trim()),s=i[1].trim().replace(/[\(\)]/g,"").trim().split(","),o={for:r,item:s[0].trim()};return Array.isArray(r)?s.length>1&&(o.index=s[1].trim()):"object"==(void 0===r?"undefined":n(r))&&r&&(s.length>1&&(o.key=s[1].trim()),s.length>2&&(o.index=s[2].trim())),o}}},{key:"parseText",value:function(e,t){var i=this;return t.replace(/\{\{(.*?)\}\}/g,function(t,r){var s=i.parseExpression(e,r.trim());return"object"===(void 0===s?"undefined":n(s))?JSON.stringify(s):String(s)})}},{key:"parseExpression",value:function(e,t){var i="";for(var n in e)i+="let "+n+" = scope['"+n+"'];";return i+="return "+t,new Function("scope",i)(e)}},{key:"executeExpression",value:function(e,t){var i="";for(var n in e)i+="let "+n+" = scope['"+n+"'];";for(var r in i+=t+";",e)i+="scope['"+r+"'] = "+r+";";return new Function("scope",i)}}]),e}();e.exports=s},function(e,t,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=i(2),s=i(0);e.exports={proxy:function(e){if(!e||"object"!==(void 0===e?"undefined":n(e)))throw new TypeError('The argument to "proxy" must be an object');return new r(e)},useProxy:function(e){if(!(e instanceof r))throw new TypeError('The argument to "useProxy" must be an instance of State');return e.$data},h:function(e,t){if(!e)throw new TypeError("The tag name is undefined");if("string"!=typeof e)throw new TypeError("The tag name should be a string");"object"==(void 0===t?"undefined":n(t))&&t||(t={});var i=t.attrs||{},r={};Array.isArray(t.cls)?t.cls.forEach(function(e){r[e]=!0}):"object"==n(t.cls)&&t.cls?r=Object.assign({},t.cls):"string"==typeof t.cls&&t.cls?r[t.cls]=!0:r={};var s=t.directives||{},o=t.events||{},a={};for(var c in o)a[c]={handler:o[c],params:[],modifier:void 0};var f=t.text,d=t.slots||[],h=!1!==t.if;return{tag:e,attrs:i,cls:r,directives:s,events:a,text:f,slots:d,_if:h}},parse:function(e,t,i){if(!(e instanceof r))throw new TypeError('The first argument to "parse" must be an instance of State');if(!(t instanceof s))throw new TypeError('The second argument to "parse" must be an instance of VNode');if(!i)throw new TypeError("The string expression does not exist");if("string"!=typeof i)throw new TypeError("The string expression should be a string");var n=Object.assign({},e.$data);return Object.assign(n,t.getForData()),t.parseExpression(n,i)}}},function(e,t,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function s(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}var o=i(0),a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$data=this._toProxy([],t||{}),this.$watchers={},this.$vnode=null,this._vnode=null,this.$template=null,this.$directives={},this.$components={},this.onBeforeMount=function(){},this.onMounted=function(){},this.onBeforeUpdate=function(){},this.onUpdated=function(){},this._init()}return r(e,[{key:"_init",value:function(){this.directive("show",{mounted:function(e,t){t||(e.style.display="none")},updated:function(e,t){e.style.display=t?"":"none"}})}},{key:"component",value:function(e,t){if(!t)return e?this.$components[e]:this.$components;if(!e)throw new TypeError("You need to give the component a name");if(this.$components[e])throw new Error('The component named "'+e+'" is already defined');var i=[],r=null;if("function"==typeof t?r=t:"object"==(void 0===t?"undefined":n(t))&&t&&(i=t.props||[],r=t.render),"function"!=typeof r)throw new TypeError('The component named "'+e+'" need to define a handling method');this.$components[e]={props:i,render:r}}},{key:"directive",value:function(e,t){if(!t)return e?this.$directives[e]:this.$directives;if(!e)throw new TypeError("You need to give the directive a name");if(this.$directives[e])throw new Error('The directive named "'+e+'" is already defined');var i=function(){},r=function(){},s=function(){},o=function(){},a=function(){},c=function(){};"function"==typeof t?r=t:"object"==(void 0===t?"undefined":n(t))&&t&&(i=t.beforeMount||function(){},r=t.mounted||function(){},s=t.beforeUpdate||function(){},o=t.updated||function(){},a=t.beforeUnmount||function(){},c=t.unmounted||function(){}),this.$directives[e]={beforeMount:i,mounted:r,beforeUpdate:s,updated:o,beforeUnmount:a,unmounted:c}}},{key:"mount",value:function(e){if("function"==typeof this.onBeforeMount&&this.onBeforeMount.apply(this.$data),!e)throw new Error("You must specify an element to mount");if("string"==typeof e&&(e=document.body.querySelector(e)),!(e instanceof Node&&1===e.nodeType))throw new TypeError("The mount element is undefined");return this.$template=e.cloneNode(!0),this.$vnode=this._compile("vnode",e),this.$vnode.dealFor(this),this.$vnode.init(this),this.$vnode.dealComponent(this),this._vnode=this.$vnode.copy(),this._vnode.dealDirectives(this,"beforeMount"),this._vnode.render(this),e.parentNode.insertBefore(this._vnode.elm,e),e.remove(),this._vnode.dealDirectives(this,"mounted"),"function"==typeof this.onMounted&&this.onMounted.apply(this.$data),this}},{key:"_compile",value:function(e,t){var i=null;if(1==t.nodeType){var n={},r={},s={},a="",c=!0,f=!1,d=void 0;try{for(var h,u=t.attributes[Symbol.iterator]();!(c=(h=u.next()).done);c=!0){var l=h.value;if(l.nodeName.startsWith("@")){var v=l.nodeName.indexOf(":");if(v>0){var p=l.nodeName.substr(1,v-1),y=l.nodeName.substr(v+1);p&&(r[p]={modifier:y||void 0,exp:l.nodeValue})}else{var m=l.nodeName.substr(1);m&&(r[m]={modifier:void 0,exp:l.nodeValue})}}else if(l.nodeName.startsWith("#")){var g=l.nodeName.substr(1).split(".");s[g[0]]={handler:l.nodeValue,modifier:g.filter(function(e,t){return t>0})}}else"class"==l.nodeName?a=l.nodeValue.trim():"refex-cloak"!=l.nodeName&&(n[l.nodeName]=l.nodeValue)}}catch(e){f=!0,d=e}finally{try{!c&&u.return&&u.return()}finally{if(f)throw d}}i=new o(t.nodeName.toLocaleLowerCase(),n,a,r,s,void 0,e,t.nodeType);for(var b=t.childNodes,w=b.length,x=0;x<w;x++){var E=this._compile(e+"_"+x,b[x]);E&&(E.parent=i,i.children.push(E))}}else 3!=t.nodeType&&8!=t.nodeType||(i=new o(t.nodeName.toLocaleLowerCase(),{},"",{},{},t.nodeValue,e,t.nodeType));return i}},{key:"_updateVnodes",value:function(e,t,i){this.$vnode=this._compile("vnode",this.$template),this.$vnode.dealFor(this),this.$vnode.init(this),this.$vnode.dealComponent(this),this._updateVnode(this.$vnode,this._vnode)}},{key:"_updateVnode",value:function(e,t){if(e.isSame(t)){var i=!e.equal(t);i&&t.dealDirectives(this,"beforeUpdate",!1),1==e.nodeType&&t.if?(this._updateDirectives(e,t),this._updateAttrs(e,t),this._updateClass(e,t),this._updateEvents(e,t),this._updateChildren(e,t)):3==e.nodeType&&this._updateText(e,t),i&&t.dealDirectives(this,"updated",!1)}else{var n=e.copy(),r=t.parent;n.parent=r,t.dealDirectives(this,"beforeUnmount");var s=t.getIndex();r.children.splice(s,1,n),n.dealDirectives(this,"beforeMount"),n.render(this),t.elm.parentNode.insertBefore(n.elm,t.elm),t.elm.remove(),t.dealDirectives(this,"unmounted"),n.dealDirectives(this,"mounted")}}},{key:"_updateDirectives",value:function(e,t){var i=e.compare(t,"directives",0),n=e.compare(t,"directives",1),r=Object.assign(i,n);for(var s in r)t.directives[s]=Object.assign({},r[s]);var o=e.compare(t,"directives",2);for(var a in o)delete t.directives[a]}},{key:"_updateAttrs",value:function(e,t){var i=e.compare(t,"attrs",0),r=e.compare(t,"attrs",1),s=Object.assign(i,r);for(var o in s){var a=s[o];t.attrs[o]=a,!1===a||null===a||void 0===a?t.elm.removeAttribute(o):(!0===a&&(a=""),"object"===(void 0===a?"undefined":n(a))&&(a=JSON.stringify(a)),a=String(a),t.elm.setAttribute(o,a))}var c=e.compare(t,"attrs",2);for(var f in c)delete t.attrs[f],t.elm.removeAttribute(f)}},{key:"_updateClass",value:function(e,t){if(JSON.stringify(e.cls)!=JSON.stringify(t.cls)){t.cls=Object.assign({},e.cls);var i=[];for(var n in t.cls)t.cls[n]&&i.push(n);i.length?t.elm.setAttribute("class",i.join(" ")):t.elm.removeAttribute("class")}}},{key:"_updateEvents",value:function(e,t){var i=this,n=e.compare(t,"events",0);for(var r in n)t.events[r]=n[r];var o=e.compare(t,"events",1),a=function(e){t.events[e]=o[e],t.elm.addEventListener(e,function(n){t.events[e].modifier&&t.events[e].modifier.includes("self")&&n.currentTarget!=n.target||(t.events[e].modifier&&t.events[e].modifier.includes("stop")&&n.stopPropagation(),t.events[e].modifier&&t.events[e].modifier.includes("prevent")&&n.cancelable&&n.preventDefault(),"function"==typeof t.events[e].handler?t.events[e].handler.apply(i.$data,[n].concat(s(t.events[e].params))):t.executeExpression(i.$data,t.events[e].handler)(i.$data))},{once:t.events[e].modifier&&t.events[e].modifier.includes("once"),capture:t.events[e].modifier&&t.events[e].modifier.includes("capture"),passive:t.events[e].modifier&&t.events[e].modifier.includes("passive")})};for(var c in o)a(c)}},{key:"_updateChildren",value:function(e,t){var i=this;if(e.children.length==t.children.length){var n=!0,r=!1,s=void 0;try{for(var o,a=e.children[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var c=o.value,f=!0,d=!1,h=void 0;try{for(var u,l=t.children[Symbol.iterator]();!(f=(u=l.next()).done);f=!0){var v=u.value;c.id===v.id&&this._updateVnode(c,v)}}catch(e){d=!0,h=e}finally{try{!f&&l.return&&l.return()}finally{if(d)throw h}}}}catch(e){r=!0,s=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw s}}}else t.children.forEach(function(e){e.dealDirectives(i,"beforeUnmount")}),t.elm.innerHTML="",t.children.forEach(function(e){e.dealDirectives(i,"unmounted")}),t.children=[],e.children.forEach(function(e){var n=e.copy();t.children.push(n),n.dealDirectives(i,"beforeMount"),n.render(i),t.elm.appendChild(n.elm),n.dealDirectives(i,"mounted")})}},{key:"_updateText",value:function(e,t){e.text!==t.text&&(t.text=e.text,t.elm.nodeValue=t.text)}},{key:"watch",value:function(e,t){if(!e)throw new TypeError("You must specify a property to watch");if("string"!=typeof e)throw new TypeError("The watch property expected a string");"function"!=typeof t&&(t=function(){});var i=this._parseProperty(e);if(this.$watchers[i])throw new Error('The watcher for "'+e+'" is already defined');return this.$watchers[i]=t,this}},{key:"unwatch",value:function(e){if("string"==typeof e){var t=this._parseProperty(e);this.$watchers[t]&&delete this.$watchers[t]}else this.$watchers={};return this}},{key:"_toProxy",value:function(e,t,i){var n=this,r=[].concat(s(e));if(!this._isObject(t))throw new TypeError("Cannot create proxy with a non-object as target or handler");for(var o in i&&r.push(i),t)this._isObject(t[o])&&(t[o]=this._toProxy(r,t[o],o));return new Proxy(t,{get:function(e,t){return n._getter(r,e,t)},set:function(e,t,i){return n._setter(r,e,t,i)},deleteProperty:function(e,t){return n._setter(r,e,t,void 0)}})}},{key:"_getter",value:function(e,t,i){return Reflect.get(t,i)}},{key:"_setter",value:function(e,t,i,r){var o=[].concat(s(e));o.push(i);var a=null;Array.isArray(t)?a=[].concat(s(t)):"object"==(void 0===t?"undefined":n(t))&&(a=Object.assign({},t));var c=t[i];if(Array.isArray(c)?c=[].concat(s(c)):"object"==(void 0===c?"undefined":n(c))&&c&&(c=Object.assign({},c)),Reflect.set(t,i,r),c!==r){"function"==typeof this.onBeforeUpdate&&this.onBeforeUpdate.apply(this.$data,[i,r,c,t]),this._updateVnodes(o,r,c);var f=e.join(".");a&&e.length&&this.$watchers[f]&&this.$watchers[f].apply(this,[t,a]);var d=o.join(".");this.$watchers[d]&&this.$watchers[d].apply(this,[r,c]),"function"==typeof this.onUpdated&&this.onUpdated.apply(this.$data,[i,r,c,t])}return!0}},{key:"_parseProperty",value:function(e){var t=[];return e.split(".").forEach(function(e){var i=e.match(/\[(.+?)\]/g);if(i){var n=e.replace(/\[(.+?)\]/g,"");t.push(n),i.forEach(function(e){t.push(e.substr(1,e.length-2))})}else t.push(e)}),t.join(".")}},{key:"_isObject",value:function(e){return!("object"!=(void 0===e?"undefined":n(e))||!e)}}]),e}();e.exports=a}])});