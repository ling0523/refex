!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Refex=t():e.Refex=t()}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports={getFirstElement:function(e){for(var t=e.childNodes,r=t.length,n=0,i=t[n];i&&1!=i.nodeType;)++n<r&&(i=t[n]);return i},parseExp2:function(e,t,r){var n=this,i="",o=[],s=/(.*)+\((.*)\)/g.exec(r);if(s){if(i=this.parseExp(t,s[1]),s[2]&&(o=s[2].split(",").map(function(e){return n.parseExp(t,e)})),"function"!=typeof i)throw new TypeError(s[1]+" is not a function");i=i.apply(e,o)}else"function"==typeof(i=this.parseExp(t,r))&&(i=i.apply(e,o));return i},compare:function(e,t,r,n){var i={};if(0==n)for(var o in e[r])t[r].hasOwnProperty(o)&&this.string(t[r][o])!==this.string(e[r][o])&&(i[o]=e[r][o]);else if(1==n)for(var s in e[r])t[r].hasOwnProperty(s)||(i[s]=e[r][s]);else if(2==n)for(var a in t[r])e[r].hasOwnProperty(a)||(i[a]=t[r][a]);return i},equalNode:function(e,t){var r=this;return e.uid==t.uid&&e.tag==t.tag&&e.nodeType==t.nodeType&&e.if==t.if&&e.isCloned==t.isCloned&&e.ifType==t.ifType&&(1==e.nodeType?this.string(e.attrs)==this.string(t.attrs)&&(this.string(e.classes)==this.string(t.classes)&&(this.string(e.directives)==this.string(t.directives)&&(this.string(e.events)==this.string(t.events)&&(e.children.length==t.children.length&&e.children.every(function(e,n){return r.equalNode(e,t.children[n])}))))):e.text==t.text)},parseFor:function(e,t,r){var i=r.match(/([^]*?)\s+(?:in|of)\s+([^]*)/);if(i){var o=this.parseExp(t,i[2].trim());"number"==typeof o&&(o=new Array(o));var s=i[1].trim().replace(/[\(\)]/g,"").trim().split(","),a={for:o,item:s[0].trim(),exp:i[2].trim()};return Array.isArray(o)?s.length>1?a.index=s[1].trim():a.index="index":"object"==(void 0===o?"undefined":n(o))&&o&&(s.length>1?a.key=s[1].trim():a.key="key",s.length>2?a.index=s[2].trim():a.index="index"),a}},executeExp:function(e,t){var r="";for(var n in e)r+="let "+n+" = scope['"+n+"'];";for(var i in r+=t+";",e)r+="scope['"+i+"'] = "+i+";";return new Function("scope",r)},parseText:function(e,t,r){var n=this;return r.replace(/\{\{(.*?)\}\}/g,function(r,i){var o=n.parseExp2(e,t,i.trim());return n.string(o)})},parseExp:function(e,t){var r="";for(var n in e)r+="let "+n+" = scope['"+n+"'];";return r+="return "+t,new Function("scope",r)(e)},isSameNode:function(e,t){return e.tag===t.tag&&e.nodeType===t.nodeType&&e.if===t.if&&e.ifType===t.ifType},parseProperty:function(e){var t=[];return e.split(".").forEach(function(e){var r=e.match(/\[(.+?)\]/g);if(r){var n=e.replace(/\[(.+?)\]/g,"");t.push(n),r.forEach(function(e){var r=/\[(\'|\"){0,1}(.+?)(\'|\"){0,1}\]/g.exec(e);t.push(r[2])})}else t.push(e)}),t},getOriginalData:function(e){var t=null;if(Array.isArray(e)){t=[];var r=!0,n=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var a=o.value,c=this.getOriginalData(a);t.push(c)}}catch(e){n=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw i}}}else if(this.isObject(e))for(var f in t={},e){var d=this.getOriginalData(e[f]);t[f]=d}else t=e;return t},isObject:function(e){return!("object"!=(void 0===e?"undefined":n(e))||!e)},string:function(e){return this.isObject(e)?JSON.stringify(e):String(e)},deepCopy:function(e){return Array.isArray(e)?[].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(e)):this.isObject(e)?Object.assign({},e):e}}},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var s=r(0),a=function(){function e(t,r,n,i,o,s,a,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.uid=t,this.tag=r,this.nodeType=n,this.attrs=i,this.classes=o,this.directives=s,this.events=a,this.text=c,this.parent=void 0,this.children=[],this.isCloned=!1,this.elm=void 0,this.if=!0,this.forData={},this.ifType=-1,this.componentChildren=[]}return i(e,[{key:"dealFor",value:function(e){var t=this;if(this.directives.for){var r,i=this.directives.for.exp;delete this.directives.for;var o=s.getOriginalData(e.$data);Object.assign(o,this.getForData());var a=s.parseFor(e.$data,o,i);if(!a)throw new Error("Invalid @for expression: "+i);var c=this.getIndex(),f=[];if(Array.isArray(a.for))for(var d=a.for.length,l=0;l<d;l++){var u=this.clone(l);u.parent=this.parent,u.forData[a.item]=a.for[l],u.forData[a.index]=l,f.push(u),u.children.forEach(function(t){t.dealFor(e)})}else"object"==n(a.for)&&a.for&&Object.keys(a.for).forEach(function(r,n){var i=t.clone(n);i.parent=t.parent,i.forData[a.item]=a.for[r],i.forData[a.index]=n,i.forData[a.key]=r,f.push(i),i.children.forEach(function(t){t.dealFor(e)})});(r=this.parent.children).splice.apply(r,[c,1].concat(f))}else this.children.forEach(function(t){t.dealFor(e)})}},{key:"init",value:function(e){var t=this,r=s.getOriginalData(e.$data);if(Object.assign(r,this.getForData()),1==this.nodeType){if(this.directives.if){if(this.directives["else-if"]||this.directives.else)throw new Error('"@if" and "@else-if" and "@else" cannot be used on the same node');this.if=s.parseExp2(e.$data,r,this.directives.if.exp),this.ifType=0,delete this.directives.if}if(this.directives["else-if"]){if(this.directives.else)throw new Error('"@else-if" and "@else" cannot be used on the same node');var i=this.getPrevBrotherNode();if(!i||0!=i.ifType)throw new Error('"@else-if" cannot be used alone');i.if?this.if=!1:this.if=s.parseExp2(e.$data,r,this.directives["else-if"].exp),this.ifType=1,delete this.directives["else-if"]}if(this.directives.else){var o=this.getPrevBrotherNode();if(!o||0!=o.ifType&&1!=o.ifType)throw new Error('"@else" cannot be used alone');if(0==o.ifType)o.if?this.if=!1:this.if=!0;else if(1==o.ifType){var a=o.getPrevBrotherNode();if(!a||0!=a.ifType)throw new Error('"@else" cannot be used alone');o.if||a.if?this.if=!1:this.if=!0}this.ifType=2,delete this.directives.else}var c={},f=function(n){var i=s.parseText(e.$data,r,n);if(!e.$directives[i])throw new Error("The @"+i+" directive is undefined");var o={};t.directives[n].modifier.forEach(function(e){o[e]=!0}),c[i]={exp:t.directives[n].exp,modifier:o,value:s.parseExp2(e.$data,r,t.directives[n].exp)}};for(var d in this.directives)f(d);this.directives=c;var l={};for(var u in this.attrs){var h,p=null;h=s.parseText(e.$data,r,u);var v=this.attrs[u].match(/\{\{(.*?)\}\}/g),y=this.attrs[u].match(/^\{\{(.*?)\}\}$/g);if(v&&y&&1==v.length){var m=this.attrs[u].trim().length-2,g=this.attrs[u].trim().substring(2,m);p=s.parseExp2(e.$data,r,g)}else p=s.parseText(e.$data,r,this.attrs[u]);""===p&&(p=!0),l[h]=p}if(this.attrs=l,this.classes){var b={},x=this.classes.match(/\{\{(.*?)\}\}/g),w=this.classes.match(/^\{\{(.*?)\}\}$/g);if(x&&w&&1==x.length){var T=this.classes.trim().length-2,E=this.classes.trim().substring(2,T),$=s.parseExp2(e.$data,r,E);Array.isArray($)?$.forEach(function(e){b[e]=!0}):"object"==(void 0===$?"undefined":n($))&&$?b=Object.assign({},$):($=s.string($),b[$]=!0)}else s.parseText(e.$data,r,this.classes).split(/\s+/g).forEach(function(e){b[e]=!0});this.classes=b}else this.classes={};var j={};for(var C in this.events){var _=s.parseText(e.$data,r,C);j[_]=this.eventHandler(r,_,this.events[C].handler,this.events[C].modifier)}this.events=j}else 3==this.nodeType&&(this.text=s.parseText(e.$data,r,this.text));this.children.forEach(function(t){t.init(e)})}},{key:"eventHandler",value:function(e,t,r,n){var i=[],o=null;if(!r)throw new TypeError("The value of #"+t+" shoud not be undefined");var a=/(.*)+\((.*)\)/g.exec(r);a?(o=s.parseExp(e,a[1]),a[2]&&(i=a[2].split(",").map(function(t){return s.parseExp(e,t)}))):"function"!=typeof(o=s.parseExp(e,r))&&(o=r);var c={};return n.forEach(function(e){c[e]=!0}),{handler:o,params:i,modifier:c}}},{key:"dealComponent",value:function(t){var r=this.tag.toLocaleLowerCase();if(t.$components[r]){var i={};for(var a in this.attrs)t.$components[r].props.includes(a)&&(i[a]=this.attrs[a],delete this.attrs[a]);if("slot"==r){var c,f=this.getComponentChildren(),d=this.getIndex();(c=this.parent.children).splice.apply(c,[d,1].concat(o(f)))}else{var l=t.$components[r].render.apply(t.$data,[i]);if(!l)throw new Error('The template for component "'+r+'" is invalid');var u=null;if("string"==typeof l){var h=document.createElement("div");h.innerHTML=l.trim();var p=s.getFirstElement(h);if("slot"===p.nodeName.toLocaleLowerCase())throw new Error("Slot components cannot be used as direct elements of custom components");(u=t._compile(this.uid,p)).dealFor(t),u.init(t)}else"object"==(void 0===l?"undefined":n(l))&&((u=new e(this.uid,l.tag,1,l.attrs,l.classes,l.directives,l.events,void 0)).createChildrenVNodes(l),u.if=l._if);if(u){u.parent=this.parent,u.events=Object.assign(u.events,this.events),u.directives=Object.assign(u.directives,this.directives),u.classes=Object.assign(u.classes,this.classes),u.attrs=Object.assign(u.attrs,this.attrs);var v=[];this.children.forEach(function(e){var t=e.copy();v.push(t)}),u.componentChildren=v;var y=this.getIndex();this.parent.children.splice(y,1,u),u.dealComponent(t)}}}else this.children.forEach(function(e){e.dealComponent(t)})}},{key:"createChildrenVNodes",value:function(t){var r=this;if(void 0===t.text||null===t.text)t.slots.forEach(function(t,n){var i=new e(r.uid+"_"+n,t.tag,1,t.attrs,t.classes,t.directives,t.events,void 0);r.children.push(i),i.createChildrenVNodes(t)});else{var n=new e(this.uid+"_0","#text",3,{},{},{},{},s.string(t.text));this.children=[n]}}},{key:"dealDirectives",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.if&&1==this.nodeType){for(var n in this.directives){var i=e.$directives[n],o=[],a=this.directives[n].exp,c=s.deepCopy(this.directives[n].modifier),f=this.directives[n].value;o="beforeMount"==t||"unmounted"==t?[f,c,a,this]:[this.elm,f,c,a,this],i[t]&&i[t].apply(e.$data,o)}r&&this.children.forEach(function(r){r.dealDirectives(e,t)})}}},{key:"render",value:function(e){var t=this,r=null;if(this.if){if(1==this.nodeType){r=document.createElement(this.tag);var i=[];for(var a in this.classes)this.classes[a]&&i.push(a);for(var c in i.length&&r.setAttribute("class",i.join(" ")),this.attrs){var f=this.attrs[c];!1!==f&&null!==f&&void 0!==f&&(!0===f&&(f=""),"object"===(void 0===f?"undefined":n(f))&&(f=JSON.stringify(f)),f=String(f),r.setAttribute(c,f))}var d=function(n){var i=function(r){t.events[n].modifier.self&&r.currentTarget!=r.target||(t.events[n].modifier.stop&&r.stopPropagation(),t.events[n].modifier.prevent&&r.cancelable&&r.preventDefault(),"function"==typeof t.events[n].handler?t.events[n].handler.apply(e.$data,[r].concat(o(t.events[n].params))):s.executeExp(e.$data,t.events[n].handler)(e.$data))};t.events[n].fun=i,r.addEventListener(n,i,{once:!!t.events[n].modifier.once,capture:!!t.events[n].modifier.capture,passive:!!t.events[n].modifier.passive})};for(var l in this.events)d(l);this.children.forEach(function(t){t.render(e),r.appendChild(t.elm)})}else 3==this.nodeType?r=document.createTextNode(this.text):8==this.nodeType&&(r=document.createComment(this.text));this.elm=r}else this.elm=document.createComment("@if")}},{key:"getForData",value:function(){var e=s.deepCopy(this.forData);return this.parent&&Object.assign(e,this.parent.getForData()),e}},{key:"copy",value:function(){var t=new e(this.uid,this.tag,this.nodeType,s.deepCopy(this.attrs),s.deepCopy(this.classes),s.deepCopy(this.directives),s.deepCopy(this.events),this.text);t.if=this.if,t.isCloned=this.isCloned,t.forData=Object.assign({},this.forData),t.ifType=this.ifType;var r=[],n=!0,i=!1,o=void 0;try{for(var a,c=this.children[Symbol.iterator]();!(n=(a=c.next()).done);n=!0){var f=a.value.copy();f.parent=t,r.push(f)}}catch(e){i=!0,o=e}finally{try{!n&&c.return&&c.return()}finally{if(i)throw o}}return t.children=r,t}},{key:"clone",value:function(t){var r=new e(this.uid+"_copy_"+t,this.tag,this.nodeType,s.deepCopy(this.attrs),s.deepCopy(this.classes),s.deepCopy(this.directives),s.deepCopy(this.events),this.text);r.isCloned=!0;var n=[];return this.children.forEach(function(e,t){var i=e.clone(t);i.parent=r,n.push(i)}),r.children=n,r}},{key:"getPrevBrotherNode",value:function(){var e=this.getIndex();if(e<=0)return null;var t=this.parent.children[e-1];return 1!=t.nodeType&&(t=t.getPrevBrotherNode()),t}},{key:"getComponentChildren",value:function(){return this.componentChildren.length?this.componentChildren:this.parent.getComponentChildren()}},{key:"getIndex",value:function(){var e=-1;if(this.parent)for(var t=this.parent.children.length,r=0;r<t;r++)if(this.parent.children[r]===this){e=r;break}return e}}]),e}();e.exports=a},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=r(3),o=r(1),s=r(6);console.log("%c感谢使用"+s.name+"，当前版本：%c v"+s.version+"\n%c如果你觉得"+s.name+"还不错，不妨去github点个star\ngithub地址：%c"+s.repository.url,"color:#808080;","color:#008a00","color:#808080;","color:#008a00"),e.exports={proxy:function(e){if(!e||"object"!==(void 0===e?"undefined":n(e)))throw new TypeError('The argument to "proxy" must be an object');return new i(e)},useProxy:function(e){if(!(e instanceof i))throw new TypeError('The argument to "useProxy" must be an instance of State');return e.$data},h:function(e,t){if(!e)throw new TypeError("The tag name is undefined");if("string"!=typeof e)throw new TypeError("The tag name should be a string");"object"==(void 0===t?"undefined":n(t))&&t||(t={}),e=e.toLocaleLowerCase();var r=t.attrs||{},i={};Array.isArray(t.classes)?t.classes.forEach(function(e){i[e]=!0}):"object"==n(t.classes)&&t.classes?i=Object.assign({},t.classes):"string"==typeof t.classes&&t.classes?i[t.classes]=!0:i={};var o=t.directives||{},s=t.events||{},a={};for(var c in s)a[c]={handler:s[c],params:[],modifier:{}};var f=t.text,d=t.slots||[],l=!1!==t.if;return{tag:e,attrs:r,classes:i,directives:o,events:a,text:f,slots:d,_if:l}},parse:function(e,t,r){if(!(e instanceof i))throw new TypeError('The first argument to "parse" must be an instance of State');if(!(t instanceof o))throw new TypeError('The second argument to "parse" must be an instance of VNode');if(!r)throw new TypeError("The string expression does not exist");if("string"!=typeof r)throw new TypeError("The string expression should be a string");var n=Object.assign({},e.$data);return Object.assign(n,t.getForData()),t.parseExpression(n,r)}}},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var s=r(0),a=r(1),c=r(4),f=r(5),d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$data=this._toProxy([],t||{}),this.$watchers={},this.$vnode=null,this._vnode=null,this.$template=null,this.$directives={},this.$components={slot:!0},this.onBeforeMount=function(){},this.onMounted=function(){},this.onBeforeUpdate=function(){},this.onUpdated=function(){},this._init()}return i(e,[{key:"_init",value:function(){for(var e in c)this.directive(e,c[e]);for(var t in f)this.component(t,f[t])}},{key:"component",value:function(e,t){if(!t)return e?this.$components[e]:this.$components;if(!e)throw new TypeError("You need to give the component a name");if(this.$components[e])throw new Error('The component named "'+e+'" is already defined');var r=[],i=null;if("function"==typeof t?i=t:"object"==(void 0===t?"undefined":n(t))&&t&&(r=t.props||[],i=t.render),"function"!=typeof i)throw new TypeError('The component named "'+e+'" need to define a handling method');this.$components[e]={props:r,render:i}}},{key:"directive",value:function(e,t){if(!t)return e?this.$directives[e]:this.$directives;if(!e)throw new TypeError("You need to give the directive a name");if(this.$directives[e])throw new Error('The directive named "'+e+'" is already defined');var r=function(){},i=function(){},o=function(){},s=function(){},a=function(){},c=function(){};"function"==typeof t?i=t:"object"==(void 0===t?"undefined":n(t))&&t&&(r=t.beforeMount||function(){},i=t.mounted||function(){},o=t.beforeUpdate||function(){},s=t.updated||function(){},a=t.beforeUnmount||function(){},c=t.unmounted||function(){}),this.$directives[e]={beforeMount:r,mounted:i,beforeUpdate:o,updated:s,beforeUnmount:a,unmounted:c}}},{key:"mount",value:function(e){if("function"==typeof this.onBeforeMount&&this.onBeforeMount.apply(this.$data),!e)throw new Error("You must specify an element to mount");if("string"==typeof e&&(e=document.body.querySelector(e)),!(e instanceof Node&&1===e.nodeType))throw new TypeError("The mount element is undefined");return this.$template=e.cloneNode(!0),this.$vnode=this._compile("v",e),this.$vnode.dealFor(this),this.$vnode.init(this),this.$vnode.dealComponent(this),this._vnode=this.$vnode.copy(),this._vnode.dealDirectives(this,"beforeMount"),this._vnode.render(this),e.parentNode.insertBefore(this._vnode.elm,e),e.remove(),this._vnode.dealDirectives(this,"mounted"),"function"==typeof this.onMounted&&this.onMounted.apply(this.$data),this}},{key:"_compile",value:function(e,t){var r=null;if(1==t.nodeType){var n={},i={},o={},s="",c=!0,f=!1,d=void 0;try{for(var l,u=t.attributes[Symbol.iterator]();!(c=(l=u.next()).done);c=!0){var h=l.value;if(h.nodeName.startsWith("@")){var p=h.nodeName.substr(1).split(".");i[p[0]]={exp:h.nodeValue,modifier:p.filter(function(e,t){return t>0})}}else if(h.nodeName.startsWith("#")){var v=h.nodeName.substr(1).split(".");o[v[0]]={handler:h.nodeValue,modifier:v.filter(function(e,t){return t>0})}}else"class"==h.nodeName?s=h.nodeValue.trim():"refex-cloak"!=h.nodeName&&(n[h.nodeName]=h.nodeValue)}}catch(e){f=!0,d=e}finally{try{!c&&u.return&&u.return()}finally{if(f)throw d}}r=new a(e,t.nodeName.toLocaleLowerCase(),t.nodeType,n,s,i,o,void 0);for(var y=t.childNodes,m=y.length,g=0;g<m;g++){var b=this._compile(e+"_"+g,y[g]);b&&(b.parent=r,r.children.push(b))}}else 3!=t.nodeType&&8!=t.nodeType||(r=new a(e,t.nodeName.toLocaleLowerCase(),t.nodeType,{},"",{},{},t.nodeValue));return r}},{key:"_updateVNodes",value:function(e,t,r){this.$vnode=this._compile("v",this.$template),this.$vnode.dealFor(this),this.$vnode.init(this),this.$vnode.dealComponent(this),this._updateVNode(this.$vnode,this._vnode)}},{key:"_updateVNode",value:function(e,t){if(s.isSameNode(e,t)){var r=!s.equalNode(e,t);r&&t.dealDirectives(this,"beforeUpdate",!1),1==e.nodeType&&t.if?(this._updateDirectives(e,t),this._updateAttrs(e,t),this._updateClasses(e,t),this._updateEvents(e,t),this._updateChildren(e,t)):3==e.nodeType&&this._updateText(e,t),r&&t.dealDirectives(this,"updated",!1)}else{var n=e.copy(),i=t.parent;n.parent=i,t.dealDirectives(this,"beforeUnmount");var o=t.getIndex();i.children.splice(o,1,n),n.dealDirectives(this,"beforeMount"),n.render(this),t.elm.parentNode.insertBefore(n.elm,t.elm),t.elm.remove(),t.dealDirectives(this,"unmounted"),n.dealDirectives(this,"mounted")}}},{key:"_updateDirectives",value:function(e,t){var r=s.compare(e,t,"directives",0),n=s.compare(e,t,"directives",1),i=Object.assign(r,n);for(var o in i)t.directives[o]=Object.assign({},i[o]);var a=s.compare(e,t,"directives",2);for(var c in a)delete t.directives[c]}},{key:"_updateAttrs",value:function(e,t){var r=s.compare(e,t,"attrs",0),i=s.compare(e,t,"attrs",1),o=Object.assign(r,i);for(var a in o){var c=o[a];t.attrs[a]=c,!1===c||null===c||void 0===c?t.elm.removeAttribute(a):(!0===c&&(c=""),"object"===(void 0===c?"undefined":n(c))&&(c=JSON.stringify(c)),c=String(c),t.elm.setAttribute(a,c))}var f=s.compare(e,t,"attrs",2);for(var d in f)delete t.attrs[d],t.elm.removeAttribute(d)}},{key:"_updateClasses",value:function(e,t){if(s.string(e.classes)!=s.string(t.classes)){t.classes=s.deepCopy(e.classes);var r=[];for(var n in t.classes)t.classes[n]&&r.push(n);r.length?t.elm.setAttribute("class",r.join(" ")):t.elm.removeAttribute("class")}}},{key:"_updateEvents",value:function(e,t){var r=this,n=s.compare(e,t,"events",0);for(var i in n)t.events[i]=s.deepCopy(n[i]);var a=s.compare(e,t,"events",1),c=function(e){t.events[e]=s.deepCopy(a[e]);var n=function(n){t.events[e].modifier.self&&n.currentTarget!=n.target||(t.events[e].modifier.stop&&n.stopPropagation(),t.events[e].modifier.prevent&&n.cancelable&&n.preventDefault(),"function"==typeof t.events[e].handler?t.events[e].handler.apply(r.$data,[n].concat(o(t.events[e].params))):s.executeExp(r.$data,t.events[e].handler)(r.$data))};t.events[e].fun=n,t.elm.addEventListener(e,n,{once:!!t.events[e].modifier.once,capture:!!t.events[e].modifier.capture,passive:!!t.events[e].modifier.passive})};for(var f in a)c(f);var d=s.compare(e,t,"events",2);for(var l in d)t.elm.removeEventListener(l,t.events[l].fun),delete t.events[l]}},{key:"_updateChildren",value:function(e,t){var r=this;if(e.children.length==t.children.length){var n=!0,i=!1,o=void 0;try{for(var s,a=e.children[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var c=s.value,f=!0,d=!1,l=void 0;try{for(var u,h=t.children[Symbol.iterator]();!(f=(u=h.next()).done);f=!0){var p=u.value;c.uid===p.uid&&this._updateVNode(c,p)}}catch(e){d=!0,l=e}finally{try{!f&&h.return&&h.return()}finally{if(d)throw l}}}}catch(e){i=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}}else t.children.forEach(function(e){e.dealDirectives(r,"beforeUnmount")}),t.elm.innerHTML="",t.children.forEach(function(e){e.dealDirectives(r,"unmounted")}),t.children=[],e.children.forEach(function(e){var n=e.copy();t.children.push(n),n.dealDirectives(r,"beforeMount"),n.render(r),t.elm.appendChild(n.elm),n.dealDirectives(r,"mounted")})}},{key:"_updateText",value:function(e,t){e.text!==t.text&&(t.text=e.text,t.elm.nodeValue=t.text)}},{key:"watch",value:function(e,t){if(!e)throw new TypeError("You must specify a property to watch");if("string"!=typeof e)throw new TypeError("The watch property expected a string");"function"!=typeof t&&(t=function(){});var r=s.parseProperty(e).join(".");if(this.$watchers[r])throw new Error('The watcher for "'+e+'" is already defined');return this.$watchers[r]=t,this}},{key:"unwatch",value:function(e){if("string"==typeof e){var t=s.parseProperty(e).join(".");this.$watchers[t]&&delete this.$watchers[t]}else this.$watchers={};return this}},{key:"_toProxy",value:function(e,t,r){var n=this,i=[].concat(o(e));if(!s.isObject(t))throw new TypeError("Cannot create proxy with a non-object as target or handler");for(var a in r&&i.push(r),t)s.isObject(t[a])&&(t[a]=this._toProxy(i,t[a],a));return new Proxy(t,{get:function(e,t){return n._getter(i,e,t)},set:function(e,t,r){return n._setter(i,e,t,r)},deleteProperty:function(e,t){return n._setter(i,e,t,void 0)}})}},{key:"_getter",value:function(e,t,r){return Reflect.get(t,r)}},{key:"_setter",value:function(e,t,r,i){var s=[].concat(o(e));s.push(r);var a=null;Array.isArray(t)?a=[].concat(o(t)):"object"==(void 0===t?"undefined":n(t))&&(a=Object.assign({},t));var c=t[r];if(Array.isArray(c)?c=[].concat(o(c)):"object"==(void 0===c?"undefined":n(c))&&c&&(c=Object.assign({},c)),Reflect.set(t,r,i),c!==i){"function"==typeof this.onBeforeUpdate&&this.onBeforeUpdate.apply(this.$data,[r,i,c,t]),this._updateVNodes(s,i,c);var f=e.join(".");a&&e.length&&this.$watchers[f]&&this.$watchers[f].apply(this,[t,a]);var d=s.join(".");this.$watchers[d]&&this.$watchers[d].apply(this,[i,c]),"function"==typeof this.onUpdated&&this.onUpdated.apply(this.$data,[r,i,c,t])}return!0}}]),e}();e.exports=d},function(e,t,r){"use strict";e.exports={show:{mounted:function(e,t){t||(e.style.display="none")},updated:function(e,t){e.style.display=t?"":"none"}}}},function(e,t,r){"use strict";e.exports={component:{props:["name","props"],render:function(e){var t=state.component(e.name);if(!t)throw new Error('The component "'+e.name+'" is not registered');return t.render(e.props)}}}},function(e){e.exports={name:"refex",version:"0.0.3",description:"一个基于Proxy的数据响应式轻量前端框架",private:!1,main:"dist/refex.js",scripts:{serve:"cross-env NODE_ENV=development webpack",build:"cross-env NODE_ENV=production webpack"},repository:{type:"git",url:"https://github.com/lovelin0523/refex"},dependencies:{},author:"lingkai",license:"MIT",babel:{presets:["env"],plugins:[]},devDependencies:{"babel-core":"^6.26.3","babel-loader":"^7.1.5","babel-preset-env":"^1.7.0","cross-env":"^7.0.3"}}}])});